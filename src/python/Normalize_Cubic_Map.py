
# read quintic map as real coefficients Cxy
# use output from 'Normalize_Quadratic_Map.py'
# convert to complex coefficients (mu, gij cubic, gij quartic, gij quintic)
# assume quadratic coeff have already been analytically removed
# analytically remove cubic coeff, except g21, keeping quintic overflow
# see attached sheets: Normal Form of Quartic Map, Sep. 4, 2024
#                    : Final Quintic Map, Oct 30, 2024, p.10
# see attachment: Propagation of Cubic/Quartic terms, Feb 27, 2025

# conversions from complex gij to real Cxy, and back, are consistent with 'expand_z.py'
# after transposing and multiplying by appropriate column and row scales

# (this is a cleaned-up version of 'transform_cubic.py')
# March 31, 2025

import numpy as np
import sys

hdr = "0  , -0.36  , 1.0202  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20997342155426682 , -0.9778106634320061 , 0, 0, 0, 0.5731184095857457 , 0.6149560857302319 , 0.5941103417355095 , -0.664398351653028 , -0.7319255415194393 , -1.6973209998821606 , -2.078340789953884 , -0.6656898682327239 , 0.3662360577960748 ,-0.42351912547324333 , -0.8808972753613306 , 0.18330706335080005 , 1.8313837929980359 , 2.6531151523345637 , -0.0053556972155978655 , 0, 0.9778106634320061 , 0.20997342155426682 , 0, 0, 0, -0.5731184095857459 , -0.6149560857302325 , -0.5941103417355098 , 0.6643983516530276 , -0.17790122656371543 , -0.8164114343307888 , -0.5145357081882895 , 0.12662103723922324 , 1.416126276275556 ,0.6872216236313201 , 2.0173805339071396 , 2.2366497958914358 , 1.3053155470977846 , -0.3051429930574546 , 1.0599218241362742"
hdr = "1  , -0.36  , 1.021  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20986718436432175 , -0.9782476240886823 , 0, 0, 0, 0.5732662513964504 , 0.6152923724166868 , 0.5932148888538262 , -0.6645544857335283 , -0.7321473389599136 , -1.697982832236472 , -2.077890333895431 , -0.6644657096361997 , 0.36647373550900725 ,-0.4239754555946315 , -0.8809090625512598 , 0.1849960935474772 , 1.8348896390167426 , 2.652183425997526 , -0.006358774549729274 , 0, 0.9782476240886823 , 0.20986718436432175 , 0, 0, 0, -0.5732662513964504 , -0.6152923724166866 , -0.5932148888538261 , 0.6645544857335284 , -0.17817904508827298 , -0.8164864418286679 , -0.5142279084183848 , 0.1288486473288175 , 1.415753377973706 ,0.6878378447377115 , 2.018009925775303 , 2.235916119183652 , 1.3020521627050023 , -0.30459419888969413 , 1.0600483152079707"
hdr = "2  , -0.36  , 1.022  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20973455993273862 , -0.9787934891366136 , 0, 0, 0, 0.5734510279687202 , 0.6157117420870059 , 0.5920970999357423 , -0.6647492566270863 , -0.7324242931838798 , -1.6988085771694346 , -2.077327123513362 , -0.662938253391399 , 0.366770012732435 ,-0.4245451330766425 , -0.8809232638441891 , 0.18710810197766112 , 1.83926234455779 , 2.6510166147989036 , -0.007610175220841647 , 0, 0.9787934891366136 , 0.20973455993273862 , 0, 0, 0, -0.5734510279687199 , -0.6157117420870053 , -0.5920970999357418 , 0.6647492566270866 , -0.17852575087173314 , -0.8165800838534414 , -0.5138411216128025 , 0.13162710492316032 , 1.4152877721595851 ,0.6886070736768439 , 2.0187949402196663 , 2.234995559999652 , 1.2979811618934485 , -0.30390649755831284 , 1.0602066205710594"
hdr = "3  , -0.36  , 1.023  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20960212624244484 , -0.9793389818716814 , 0, 0, 0, 0.5736357752158033 , 0.6161300174131161 , 0.5909810038531808 , -0.6649435883789849 , -0.7327009220079816 , -1.6996326088814708 , -2.0767637611227863 , -0.6614138353723922 , 0.36706538249291565 ,-0.4251139956630158 , -0.8809368749994548 , 0.1892208941722272 , 1.8436244090327443 , 2.649847430676494 , -0.008858866515291663 , 0, 0.9793389818716814 , 0.20960212624244484 , 0, 0, 0, -0.5736357752158032 , -0.6161300174131161 , -0.5909810038531811 , 0.6649435883789848 , -0.17887182805950308 , -0.8166735939873081 , -0.5134520871355785 , 0.1343988564086821 , 1.4148227403761033 ,0.6893751411727846 , 2.0195780406673842 , 2.2340711777987643 , 1.2939192814988545 , -0.3032169112733504 , 1.0603651360990713"
hdr = "4  , -0.36  , 1.024  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20946988283227083 , -0.9798841031140071 , 0, 0, 0, 0.573820492309315 , 0.6165472028701309 , 0.5898665962974184 , -0.6651374827419223 , -0.7329772251008306 , -1.7004549316583888 , -2.0762002508617403 , -0.6598924465687288 , 0.3673598485811583 ,-0.4256820454435728 , -0.8809498978897602 , 0.19133445204454386 , 1.8479758621488271 , 2.6486758944996636 , -0.010104857392481514 , 0, 0.9798841031140071 , 0.20946988283227083 , 0, 0, 0, -0.5738204923093153 , -0.6165472028701313 , -0.589866596297419 , 0.6651374827419216 , -0.17921727858925238 , -0.8167669706394769 , -0.5130608217704317 , 0.13716392492149554 , 1.4143582821011997 ,0.6901420497687666 , 2.0203592304502225 , 2.2331429993083383 , 1.2898664962272735 , -0.3025254544311097 , 1.0605238589866999"
hdr = "5  , -0.36  , 1.0242  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20944345694338212 , -0.9799930828553004 , 0, 0, 0, 0.5738574320371904 , 0.616630509569396 , 0.5896439170314289 , -0.6651762092814291 , -0.7330324466029126 , -1.7006191915177327 , -2.0760875314269867 , -0.6595885315234482 , 0.3674186336902372 ,-0.4257955580461709 , -0.8809524320410327 , 0.19175725391780546 , 1.8488448820171524 , 2.648441306844115 , -0.010353732303496732 , 0, 0.9799930828553004 , 0.20944345694338212 , 0, 0, 0, -0.5738574320371899 , -0.6166305095693956 , -0.5896439170314287 , 0.665176209281429 , -0.17928629366601212 , -0.8167856298136853 , -0.5129823024598885 , 0.13771613869581922 , 1.414265459221047 ,0.6902952926430083 , 2.020515239420603 , 2.2329569103958216 , 1.2890570283668827 , -0.3023869398564679 , 1.060555628202137"
hdr = "6  , -0.36  , 1.0244  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20941703864364294 , -0.9801020477760995 , 0, 0, 0, 0.5738943705195128 , 0.6167137728875356 , 0.589421305100479 , -0.6652149184090563 , -0.7330876550601405 , -1.7007833832247108 , -2.0759748062744734 , -0.6592847372160652 , 0.36747738283333925 ,-0.4259090382363408 , -0.8809549427517415 , 0.19218008555642346 , 1.8497134788528033 , 2.6482066261009822 , -0.010602499625917 , 0, 0.9801020477760995 , 0.20941703864364294 , 0, 0, 0, -0.5738943705195128 , -0.616713772887536 , -0.5894213051004797 , 0.665214918409056 , -0.17935528376893548 , -0.8168042835733743 , -0.5129036947138663 , 0.13826808625649012 , 1.4141726592559996 ,0.6904484892827931 , 2.0206711721246076 , 2.2327706709064206 , 1.2882479231008588 , -0.3022483511462005 , 1.0605874055784479"
hdr = "7  , -0.36  , 1.0246  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2093906279293873 , -0.9802109978829219 , 0, 0, 0, 0.5739313077497563 , 0.6167969928600157 , 0.5891987604703262 , -0.6652536101386931 , -0.7331428504699459 , -1.7009475068134068 , -2.075862075436844 , -0.6589810635750111 , 0.36753609604048576 ,-0.42602248603065485 , -0.8809574300369178 , 0.19260294681754603 , 1.8505816528921948 , 2.6479718524351465 , -0.010851159430849217 , 0, 0.9802109978829219 , 0.2093906279293873 , 0, 0, 0, -0.5739313077497561 , -0.6167969928600154 , -0.5891987604703254 , 0.665253610138693 , -0.1794242489133747 , -0.816822931906135 , -0.5128249986650221 , 0.13881976778707317 , 1.4140798822018272 ,0.6906016397083102 , 2.020827028588966 , 2.23258428105156 , 1.2874391802278669 , -0.30210968841421126 , 1.060619191093522"
hdr = "8  , -0.36  , 1.0248  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.209364224796952 , -0.9803199331822798 , 0, 0, 0, 0.573968243721408 , 0.6168801695222579 , 0.5889762831067561 , -0.6652922844842164 , -0.7331980328297787 , -1.7011115623178852 , -2.075749338946706 , -0.6586775105287795 , 0.36759477334166757 ,-0.42613590144566876 , -0.8809598939115811 , 0.1930258375585493 , 1.851449404371603 , 2.6477369860112714 , -0.011099711789338412 , 0, 0.9803199331822798 , 0.209364224796952 , 0, 0, 0, -0.5739682437214082 , -0.616880169522258 , -0.5889762831067571 , 0.6652922844842164 , -0.17949318911465997 , -0.8168415747995954 , -0.5127462144458237 , 0.139371183470949 , 1.4139871280542964 ,0.6907547439397324 , 2.020982808840427 , 2.2323977410424245 , 1.2866307995467223 , -0.30197095177427724 , 1.0606509847252832"
hdr = "9  , -0.36  , 1.0249  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20935102607277264 , -0.9803743952811933 , 0, 0, 0, 0.5739867112332298 , 0.6169217416231028 , 0.5888650696392527 , -0.6653116151422689 , -0.7332256191151588 , -1.7011935645491865 , -2.07569296859212 , -0.6585257792063905 , 0.36762409853688505 ,-0.426192597016109 , -0.8809611170746705 , 0.19323729393948597 , 1.8518831217251255 , 2.647619518066464 , -0.01122394769835236 , 0, 0.9803743952811933 , 0.20935102607277264 , 0, 0, 0, -0.5739867112332295 , -0.6169217416231026 , -0.5888650696392526 , 0.6653116151422688 , -0.17952764986640915 , -0.816850894202733 , -0.5127067893136972 , 0.1396467916776427 , 1.4139407595691984 ,0.6908312787389581 , 2.021060670394683 , 2.232304414795922 , 1.286226744965237 , -0.3019015557743395 , 1.0606668845780354"
hdr = "10  , -0.36  , 1.02492  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20934838655524127 , -0.9803852872570191 , 0, 0, 0, 0.5739904046975687 , 0.6169300547454147 , 0.5888428289623471 , -0.6653154807529235 , -0.73323113598063 , -1.7012099629543138 , -2.0756816943529586 , -0.6584954365568273 , 0.3676299624999768 ,-0.4262039351594946 , -0.8809613610055883 , 0.1932795860942303 , 1.8519698525287052 , 2.647596021701496 , -0.011248791659671659 , 0, 0.9803852872570191 , 0.20934838655524127 , 0, 0, 0, -0.5739904046975687 , -0.616930054745415 , -0.5888428289623475 , 0.6653154807529236 , -0.17953454126909124 , -0.8168527579196746 , -0.5126989016475839 , 0.13970190535109095 , 1.413931486559202 ,0.6908465843138056 , 2.0210762404202405 , 2.2322857450506373 , 1.2861459449064494 , -0.30188767436177166 , 1.060670064791181"
hdr = "11  , -0.36  , 1.02494  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20934574711346945 , -0.980396179084874 , 0, 0, 0, 0.5739940981492186 , 0.6169383674351903 , 0.5888205889575604 , -0.6653193461899592 , -0.7332366527155623 , -1.701226360679144 , -2.0756704200577936 , -0.6584650951120693 , 0.3676358261044891 ,-0.42621527297935247 , -0.8809616047026398 , 0.1933218785414991 , 1.8520565791104677 , 2.647572524411581 , -0.01127363454766317 , 0, 0.980396179084874 , 0.20934574711346945 , 0, 0, 0, -0.5739940981492186 , -0.6169383674351904 , -0.5888205889575606 , 0.665319346189959 , -0.17954143242258755 , -0.8168546215820265 , -0.5126910131018817 , 0.13975701636900406 , 1.4139222137782053 ,0.6908618894270359 , 2.0210918096840986 , 2.23226707380718 , 1.286065148466364 , -0.30187379221194155 , 1.0606732450851415"
hdr = "12  , -0.36  , 1.02496  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20934310774745374 , -0.9804070707647651 , 0, 0, 0, 0.5739977915881724 , 0.6169466796924666 , 0.5887983496248589 , -0.6653232114533898 , -0.7332421693199515 , -1.7012427577237137 , -2.075659145706661 , -0.6584347548720456 , 0.3676416893504505 ,-0.4262266104757001 , -0.8809618481658491 , 0.19336417128114097 , 1.8521433014706497 , 2.6475490261968844 , -0.011298476362395005 , 0, 0.9804070707647651 , 0.20934310774745374 , 0, 0, 0, -0.5739977915881722 , -0.6169466796924665 , -0.588798349624859 , 0.6653232114533898 , -0.17954832332691328 , -0.8168564851897779 , -0.5126831236767284 , 0.139812124731564 , 1.413912941226205 ,0.6908771940786682 , 2.0211073781862874 , 2.2322484010657724 , 1.285984355644779 , -0.30185990932496304 , 1.0606764254598982"
hdr = "13  , -0.36  , 1.02497  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20934178809285334 , -0.980412516549226 , 0, 0, 0, 0.5739996383028857 , 0.6169508356589273 , 0.5887872302105304 , -0.6653251440200069 , -0.7332449275731904 , -1.701250955990908 , -2.075653508510114 , -0.6584195852037881 , 0.36764462083898364 ,-0.4262322791025609 , -0.8809619698097613 , 0.19338531776055762 , 1.852186661067711 , 2.6475372767427903 , -0.011310896867310266 , 0, 0.980412516549226 , 0.20934178809285334 , 0, 0, 0, -0.5739996383028854 , -0.6169508356589273 , -0.5887872302105305 , 0.665325144020007 , -0.17955176868564132 , -0.8168574169731725 , -0.512679178634396 , 0.13983967791714058 , 1.4139083050360755 ,0.6908848462313889 , 2.0211151621517587 , 2.2322390641333993 , 1.2859439605908651 , -0.30185296760508046 , 1.060678015677565"
hdr = "14  , -0.36  , 1.024977  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20934086434590085 , -0.9804163285763408 , 0, 0, 0, 0.5740009310012951 , 0.6169537447711231 , 0.5887794467204638 , -0.6653264967908178 , -0.7332468583310399 , -1.7012566946767627 , -2.0756495624642106 , -0.658408966615194 , 0.36764667282762936 ,-0.42623624709324526 , -0.8809620549257178 , 0.1934001203396144 , 1.8522170121577517 , 2.6475290519873966 , -0.011319591061120932 , 0, 0.9804163285763408 , 0.20934086434590085 , 0, 0, 0, -0.574000931001295 , -0.6169537447711227 , -0.588779446720464 , 0.665326496790818 , -0.1795541803996901 , -0.8168580692134236 , -0.5126764169739724 , 0.1398589647521039 , 1.413905059737046 ,0.6908902026696377 , 2.021120610814297 , 2.232232528057959 , 1.2859156845913295 , -0.30184810829153413 , 1.0606791288419442"
hdr = "15  , -0.36  , 1.0249777  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.209340771971716 , -0.9804167097780551 , 0, 0, 0, 0.574001060271051 , 0.6169540356794291 , 0.5887786683759852 , -0.6653266320667303 , -0.7332470514059468 , -1.7012572685407679 , -2.075649167859247 , -0.6584079047644515 , 0.3676468780240798 ,-0.4262366438901349 , -0.88096206343574 , 0.19340160059948897 , 1.8522200472383183 , 2.647528229505635 , -0.011320460473272176 , 0, 0.9804167097780551 , 0.209340771971716 , 0, 0, 0, -0.5740010602710511 , -0.6169540356794291 , -0.5887786683759857 , 0.6653266320667304 , -0.1795544215694167 , -0.8168581344370821 , -0.5126761408020061 , 0.13986089341771268 , 1.4139047352086882 ,0.6908907383103541 , 2.021121155675423 , 2.232231874440329 , 1.2859128570157543 , -0.3018476223552151 , 1.0606792401589293"
hdr = "0  , -0.36  , 1.0250  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20933782924267566 , -0.9804288536806809 , 0, 0, 0, 0.5740051784279644 , 0.616963302909655 , 0.588753872975575 , -0.6653309414594891 , -0.7332532021370904 , -1.7012755497721945 , -2.075636596836605 , -0.6583740780059157 , 0.3676534147668419 ,-0.4262492844979223 , -0.8809623343907672 , 0.19344875763699648 , 1.8523167335271848 , 2.6475020269937852 , -0.011348156772369528 , 0, 0.9804288536806809 , 0.20933782924267566 , 0, 0, 0, -0.5740051784279644 , -0.6169633029096551 , -0.5887538729755746 , 0.6653309414594891 , -0.17956210438811063 , -0.8168602122414195 , -0.512667342188579 , 0.1399223334913533 , 1.4138943968091682 ,0.6909078019972166 , 2.021138512905743 , 2.232211051089919 , 1.285822780856311 , -0.30183214134001773 , 1.0606827864516957"
hdr = "0  , -0.36  , 1.024  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20946988283227083 , -0.9798841031140071 , 0, 0, 0, 0.573820492309315 , 0.6165472028701309 , 0.5898665962974184 , -0.6651374827419223 , -0.7329772251008306 , -1.7004549316583888 , -2.0762002508617403 , -0.6598924465687288 , 0.3673598485811583 ,-0.4256820454435728 , -0.8809498978897602 , 0.19133445204454386 , 1.8479758621488271 , 2.6486758944996636 , -0.010104857392481514 , 0, 0.9798841031140071 , 0.20946988283227083 , 0, 0, 0, -0.5738204923093153 , -0.6165472028701313 , -0.589866596297419 , 0.6651374827419216 , -0.17921727858925238 , -0.8167669706394769 , -0.5130608217704317 , 0.13716392492149554 , 1.4143582821011997 ,0.6901420497687666 , 2.0203592304502225 , 2.2331429993083383 , 1.2898664962272735 , -0.3025254544311097 , 1.0605238589866999";

#hdr = "1  , -0.36  , 1.0255  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2092718734874324 , -0.980701090215163 , 0, 0, 0, 0.574097509616992 , 0.6171709472825957 , 0.5881981415651697 , -0.6654275079936579 , -0.7333910682839825 , -1.7016852209116886 , -2.0753547171871745 , -0.6576160235201038 , 0.3677998615685369 ,-0.4265326006498772 , -0.88096833333222 , 0.194506185251568 , 1.8544832102978281 , 2.6469142254300637 , -0.011968799927572271 , 0, 0.980701090215163 , 0.2092718734874324 , 0, 0, 0, -0.5740975096169919 , -0.6171709472825955 , -0.58819814156517 , 0.665427507993658 , -0.17973428361282234 , -0.8169067819144307 , -0.5124697772455938 , 0.14129904746552602 , 1.413662668866477 ,0.6912902452620756 , 2.021527439930323 , 2.2317436715881738 , 1.2838043165211421 , -0.30148479314865373 , 1.0607623260375174"
#hdr = "2  , -0.36  , 1.0260 , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2092059650157399 , -0.9809732343857738 , 0, 0, 0, 0.5741898327575083 , 0.6173783219599408 , 0.5876428296105662 , -0.6655239662662369 , -0.7335288527974484 , -1.7020944674811918 , -2.0750728031224135 , -0.6568587207452907 , 0.3679460847987685 ,-0.42681571489554615 , -0.8809741863810117 , 0.1955637931200544 , 1.856647052703025 , 2.646325848741433 , -0.012588773535660208 , 0, 0.9809732343857738 , 0.2092059650157399 , 0, 0, 0, -0.5741898327575082 , -0.6173783219599407 , -0.5876428296105655 , 0.6655239662662371 , -0.17990630737275054 , -0.816953317246662 , -0.5122716649495973 , 0.14267410504221567 , 1.413431083970755 ,0.6916724003798638 , 2.0219158913772244 , 2.231275359540487 , 1.2817881102351365 , -0.30113698622121726 , 1.060841915734693"
#hdr = "0  , -0.36  , 1.0265  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20914010377061085 , -0.9812452862938028 , 0, 0, 0, 0.5742821477488264 , 0.6175854274915964 , 0.587087936579584 , -0.6656203164926408 , -0.7336665556385107 , -1.7025032900108612 , -2.0747908551468477 , -0.6561021685697143 , 0.36809208492289835 ,-0.42709862749204613 , -0.880979893772386 , 0.19662157903364538 , 1.858808264421282 , 2.645736899478583 , -0.013208078700623488 , 0, 0.9812452862938028 , 0.20914010377061085 , 0, 0, 0, -0.5742821477488264 , -0.6175854274915967 , -0.5870879365795842 , 0.6656203164926409 , -0.18007817590585842 , -0.816999818048212 , -0.5120730073532198 , 0.14404750907048636 , 1.4131996420552995 ,0.69205426766414 , 2.022303867665226 , 2.230806118220958 , 1.2797741588656195 , -0.3007887223218074 , 1.0609215552018438";
#hdr = "1  , -0.36  , 1.0270  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2090742896951572 , -0.981517246040354 , 0, 0, 0, 0.5743744544906881 , 0.6177922644260317 , 0.5865334619410147 , -0.6657165588877272 , -0.7338041767685505 , -1.7029116890299931 , -2.074508873763052 , -0.6553463658838178 , 0.3682378624049991 ,-0.4273813386958689 , -0.8809854557417548 , 0.1976795407914012 , 1.860966849125743 , 2.6451473801833854 , -0.01382671652402731 , 0, 0.981517246040354 , 0.2090742896951572 , 0, 0, 0, -0.5743744544906879 , -0.6177922644260315 , -0.5865334619410145 , 0.6657165588877274 , -0.18024988944946713 , -0.8170462841305219 , -0.511873806502233 , 0.1454192623928825 , 1.4129683430531852 ,0.692435847427796 , 2.022691369213416 , 2.2303359508935032 , 1.2777624592843215 , -0.3004400032091278 , 1.0610012440989984";
#hdr = "0  , -0.36  , 1.0271  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2090611325354287 , -0.9815716269391708 , 0, 0, 0, 0.5743929148403335 , 0.6178335996294156 , 0.586422617173713 , -0.665735794445854 , -0.7338316911858638 , -1.702993318059073 , -2.0744524735213963 , -0.6551952951879162 , 0.3682669912251246 ,-0.4274378567920394 , -0.8809865507057151 , 0.1978911540511212 , 1.8613982511478342 , 2.645029408143532 , -0.013950364104487883 , 0, 0.9815716269391708 , 0.2090611325354287 , 0, 0, 0, -0.5743929148403335 , -0.6178335996294153 , -0.5864226171737135 , 0.6657357944458542 , -0.18028421358028793 , -0.8170555731641768 , -0.5118339013210265 , 0.14569341522233825 , 1.4129221003964574 ,0.6925121289055409 , 2.0227688125911816 , 2.2302418065935745 , 1.277360389307677 , -0.3003702049153899 , 1.0610171877802081";
#hdr = "1  , -0.36  , 1.0272  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20904797725976135 , -0.981626004156372 , 0, 0, 0, 0.5744113748552102 , 0.6178749241151664 , 0.5863117891166598 , -0.6657550257010145 , -0.7338592023329011 , -1.7030749301730967 , -2.0743960719674446 , -0.6550442544184537 , 0.3682961111617795 ,-0.42749436684478387 , -0.8809876398641037 , 0.19810277423935577 , 1.861829548265425 , 2.644911413423966 , -0.01407398504404056 , 0, 0.981626004156372 , 0.20904797725976135 , 0, 0, 0, -0.5744113748552093 , -0.6178749241151662 , -0.58631178911666 , 0.6657550257010147 , -0.18031853152288901 , -0.8170648608000779 , -0.5117939745074944 , 0.14596750215967824 , 1.4128758634530443 ,0.6925883988974478 , 2.0228462369994893 , 2.2301476254095034 , 1.2769584092526327 , -0.30030038849727203 , 1.0610331334223733";
#hdr = "2  , -0.36  , 1.0273  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20903482386770164 , -0.9816803776927643 , 0, 0, 0, 0.5744298345345207 , 0.6179162378876495 , 0.5862009777656165 , -0.6657742526549179 , -0.7338867102093584 , -1.703156525376282 , -2.074339669105178 , -0.6548932435665833 , 0.3683252222186595 ,-0.4275508688561436 , -0.8809887232188021 , 0.19831440133860795 , 1.8622607405078089 , 2.6447933960448817 , -0.01419757935146454 , 0, 0.9816803776927643 , 0.20903482386770164 , 0, 0, 0, -0.5744298345345203 , -0.6179162378876494 , -0.5862009777656161 , 0.6657742526549177 , -0.18035284327915796 , -0.8170741470367355 , -0.5117540260779002 , 0.14624152322754846 , 1.4128296322223992 ,0.6926646574060097 , 2.0229236424416897 , 2.230053407367237 , 1.2765565190942119 , -0.30023055396876813 , 1.0610490810227844";
#hdr = "3  , -0.36  , 1.0274  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20902167235879632 , -0.9817347475491529 , 0, 0, 0, 0.5744482938774718 , 0.6179575409512308 , 0.5860901831163517 , -0.6657934753092751 , -0.7339142148149338 , -1.7032381036728554 , -2.0742832649385985 , -0.6547422626234671 , 0.36835432439945726 ,-0.42760736282816203 , -0.8809898007716976 , 0.19852603533140117 , 1.8626918279042992 , 2.644675356026488 , -0.014321147035531834 , 0, 0.9817347475491529 , 0.20902167235879632 , 0, 0, 0, -0.5744482938774718 , -0.6179575409512306 , -0.5860901831163517 , 0.6657934753092754 , -0.18038714885098373 , -0.8170834318726624 , -0.5117140560485017 , 0.14651547844858281 , 1.4127834067039897 ,0.6927409044337203 , 2.0230010289211515 , 2.2299591524927425 , 1.2761547188074784 , -0.3001607013438638 , 1.0610650305787508";
#hdr = "2  , -0.36  , 1.0275  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20900852273259177 , -0.9817891137263437 , 0, 0, 0, 0.5744667528832683 , 0.6179988333102718 , 0.5859794051646311 , -0.6658126936657951 , -0.733941716149324 , -1.7033196650670324 , -2.074226859471686 , -0.6545913115802657 , 0.36838341770786176 ,-0.42766384876288105 , -0.8809908725246782 , 0.19873767620026073 , 1.8631228104841804 , 2.6445572933889587 , -0.01444468810501412 , 0, 0.9817891137263437 , 0.20900852273259177 , 0, 0, 0, -0.5744667528832684 , -0.6179988333102722 , -0.5859794051646317 , 0.6658126936657952 , -0.18042144824025497 , -0.8170927153063742 , -0.5116740644355451 , 0.1467893678454094 , 1.412737186897273 ,0.69281713998307 , 2.0230783964412256 , 2.2298648608119476 , 1.2757530083674704 , -0.3000908306365315 , 1.061080982087575";
#hdr = "5  , -0.36  , 1.0276  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20899537498863494 , -0.9818434762251418 , 0, 0, 0, 0.5744852115511161 , 0.6180401149691345 , 0.5858686439062257 , -0.6658319077261857 , -0.7339692142122262 , -1.7034012095630326 , -2.074170452708428 , -0.6544403904281454 , 0.3684125021475608 ,-0.427720326662338 , -0.8809919384796318 , 0.19894932392772646 , 1.8635536882767323 , 2.6444392081524666 , -0.014568202568676497 , 0, 0.9818434762251418 , 0.20899537498863494 , 0, 0, 0, -0.5744852115511161 , -0.6180401149691344 , -0.5858686439062262 , 0.6658319077261861 , -0.1804557414488566 , -0.8171019973363898 , -0.5116340512552684 , 0.14706319144064128 , 1.4126909728017127 ,0.6928933640565493 , 2.0231557450052744 , 2.229770532350771 , 1.2753513877492555 , -0.3000209418607398 , 1.0610969355465658";
#hdr = "6  , -0.36  , 1.0277  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20898222912647288 , -0.9818978350463525 , 0, 0, 0, 0.5745036698802218 , 0.6180813859321755 , 0.5857578993369027 , -0.6658511174921546 , -0.7339967090033392 , -1.7034827371650718 , -2.0741140446528 , -0.6542894991582753 , 0.36844157772224073 ,-0.42777679652857453 , -0.8809929986384404 , 0.199160978496358 , 1.8639844613112349 , 2.6443211003371547 , -0.014691690435282179 , 0, 0.9818978350463525 , 0.20898222912647288 , 0, 0, 0, -0.5745036698802217 , -0.618081385932176 , -0.5857578993369025 , 0.6658511174921544 , -0.18049002847867482 , -0.8171112779612238 , -0.5115940165238926 , 0.14733694925688934 , 1.4126447644167643 ,0.6929695766566473 , 2.0232330746166505 , 2.229676167135107 , 1.2749498569278908 , -0.2999510350304412 , 1.061112890953028";
#hdr = "7  , -0.36  , 1.0278  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20896908514565266 , -0.9819521901907796 , 0, 0, 0, 0.5745221278697947 , 0.6181226462037508 , 0.5856471714524392 , -0.6658703229654086 , -0.734024200522366 , -1.703564247877368 , -2.07405763530879 , -0.6541386377618319 , 0.36847064443558664 ,-0.42783325836362823 , -0.8809940530029958 , 0.1993726398887245 , 1.8644151296169502 , 2.6442029699631813 , -0.014815151713586827 , 0, 0.9819521901907796 , 0.20896908514565266 , 0, 0, 0, -0.5745221278697948 , -0.6181226462037511 , -0.585647171452439 , 0.6658703229654084 , -0.18052430933159277 , -0.8171205571794041 , -0.5115539602576307 , 0.1476106413167394 , 1.412598561741895 ,0.6930457777858567 , 2.023310385278729 , 2.2295817651908565 , 1.2745484158784657 , -0.29988111015959673 , 1.0611288483042796";
#hdr = "8  , -0.36  , 1.0279  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2089559430457215 , -0.9820065416592286 , 0, 0, 0, 0.5745405855190411 , 0.6181638957882135 , 0.5855364602486057 , -0.6658895241476519 , -0.734051688769001 , -1.7036457417041297 , -2.0740012246803614 , -0.6539878062299878 , 0.3684997022912775 ,-0.4278897121695345 , -0.8809951015751811 , 0.19958430808740368 , 1.8648456932231285 , 2.6440848170506523 , -0.014938586412348076 , 0, 0.9820065416592286 , 0.2089559430457215 , 0, 0, 0, -0.5745405855190406 , -0.6181638957882133 , -0.5855364602486055 , 0.6658895241476519 , -0.1805585840094946 , -0.8171298349894485 , -0.5115138824726861 , 0.1478842676427793 , 1.4125523647765574 ,0.6931219674466582 , 2.023387676994853 , 2.2294873265438753 , 1.2741470645760489 , -0.29981116726214263 , 1.0611448075976289";
#hdr = "3  , -0.36  , 1.0280  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.2089428028262268 , -0.9820608894525032 , 0, 0, 0, 0.5745590428271706 , 0.618205134689915 , 0.5854257657211747 , -0.6659087210405905 , -0.7340791737429485 , -1.703727218649576 , -2.073944812771489 , -0.6538370045539195 , 0.3685287512929964 ,-0.4279461579483314 , -0.8809961443568843 , 0.19979598307499738 , 1.8652761521590366 , 2.643966641619685 , -0.015061994540318008 , 0, 0.9820608894525032 , 0.2089428028262268 , 0, 0, 0, -0.5745590428271705 , -0.6182051346899151 , -0.5854257657211747 , 0.6659087210405903 , -0.18059285251426224 , -0.8171391113898858 , -0.5114737831852487 , 0.14815782825759127 , 1.4125061735202122 ,0.6931981456415433 , 2.0234649497683947 , 2.229392851220019 , 1.273745802995722 , -0.2997412063520053 , 1.061160768830393";
#hdr = "4  , -0.36  , 1.0285  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20887712991947444 , -0.9823325733193787 , 0, 0, 0, 0.5746513242234281 , 0.6184111691091302 , 0.5848725430823585 , -0.6660046412253064 , -0.7342165495119105 , -1.7041343503043758 , -2.073662734159295 , -0.6530834437018496 , 0.36867386362064286 ,-0.4282282665068553 , -0.8810012714742455 , 0.20085445923820386 , 1.8674268778074163 , 2.6433754273912626 , -0.015678636924258166 , 0, 0.9823325733193787 , 0.20887712991947444 , 0, 0, 0, -0.5746513242234279 , -0.6184111691091301 , -0.5848725430823585 , 0.6660046412253061 , -0.18076410250689404 , -0.8171854721964984 , -0.5112729647766325 , 0.14952464645246477 , 1.4122753028544395 ,0.6935788647141464 , 2.02385102961499 , 2.228919925351409 , 1.271740840054192 , -0.2993911320982154 , 1.061240603991655";
#hdr = "5  , -0.36  , 1.0290  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.20881150395584616 , -0.9826041654273308 , 0, 0, 0, 0.5747435969734983 , 0.6186169371106636 , 0.5843197367208655 , -0.6661004544325844 , -0.7343538434190579 , -1.7045410605573377 , -2.073380624130033 , -0.6523306279233171 , 0.36881875514976775 ,-0.42851017469246994 , -0.8810062541127883 , 0.20191310252025105 , 1.8695749910810684 , 2.6427836532107185 , -0.0162946163487582 , 0, 0.9826041654273308 , 0.20881150395584616 , 0, 0, 0, -0.5747435969734984 , -0.6186169371106635 , -0.5843197367208656 , 0.6661004544325841 , -0.18093519845292075 , -0.8172317975429734 , -0.5110716112282179 , 0.15088982524660477 , 1.4120445748321828 ,0.6939592975111601 , 2.0242366364013926 , 2.2284460864297997 , 1.2697381164324393 , -0.2990406096125139 , 1.0613204872369462";

#hdr = "0  , -0.2  , 1.0106  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11084878659191516 , -0.9938589030725798 , 0, 0, 0, 0.5237621766743876 , 0.5992204382452563 , 0.1578843913287421 , -0.6231256753094531 , -0.6474010841788373 , -1.562116533067607 , -1.490222379076093 , -0.1478706798381147 , 0.3830553536868907 ,-0.3933159913201433 , -0.4618309139410465 , 0.9852606911952833 , 2.3935280556085097 , 1.567558819268681 , -0.26050408145752924 , 0, 0.9938589030725798 , 0.11084878659191516 , 0, 0, 0, -0.5237621766743877 , -0.5992204382452562 , -0.1578843913287421 , 0.6231256753094532 , -0.2560305943226563 , -0.7102602737333765 , -0.19937050259309216 , 0.8492695258904477 , 1.0907444733687544 ,0.6643728796036082 , 1.620082796176852 , 1.3329354341545718 , 0.2839068618620634 , 0.23109609743600956 , 0.8886698690819085";
#hdr = "1  , -0.2  , 1.011  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11082385954856047 , -0.9940640919299027 , 0, 0, 0, 0.5238615316861075 , 0.5993403823229724 , 0.1576293952923773 , -0.6232004073871735 , -0.6475444744939478 , -1.5624581189182807 , -1.4902228673732256 , -0.1475868172353994 , 0.38313319617517455 ,-0.3934998842985967 , -0.46188572654521987 , 0.9860144060296919 , 2.3944621271928326 , 1.5673307451407381 , -0.2607610967057409 , 0, 0.9940640919299027 , 0.11082385954856047 , 0, 0, 0, -0.5238615316861075 , -0.5993403823229726 , -0.15762939529237774 , 0.6232004073871733 , -0.2561261079724309 , -0.710342070304691 , -0.19912462841989595 , 0.8498268232873976 , 1.0907294703499044 ,0.6646343335366466 , 1.6204533374489603 , 1.3326904959935713 , 0.2833412968318332 , 0.23140637310077128 , 0.8888393497220011";
#hdr = "2  , -0.2  , 1.012  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11076159415600578 , -0.9945768678222249 , 0, 0, 0, 0.5241097416366695 , 0.599639903678549 , 0.15699237655918286 , -0.6233870577753106 , -0.6479025550056741 , -1.5633110566111996 , -1.4902236440698564 , -0.14687777840934618 , 0.3833275237859058 ,-0.3939593618313162 , -0.46202254080144783 , 0.9878978887212164 , 2.3967944153349308 , 1.5667597984714634 , -0.26140312882622724 , 0, 0.9945768678222249 , 0.11076159415600578 , 0, 0, 0, -0.5241097416366697 , -0.5996399036785491 , -0.15699237655918286 , 0.6233870577753102 , -0.25636466929130464 , -0.7105462096490276 , -0.19850994594594332 , 0.851218391989448 , 1.090691856037448 ,0.6652874691015747 , 1.6213784849885902 , 1.3320771281584882 , 0.28192862384422135 , 0.2321820333684952 , 0.88926271040757";
#hdr = "3  , -0.2  , 1.013  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11069940324386887 , -0.9950893637319774 , 0, 0, 0, 0.5243576981522252 , 0.5999389420793654 , 0.15635603039366874 , -0.6235734518443597 , -0.6482600714680646 , -1.564162529463498 , -1.4902237886749596 , -0.1461696210623859 , 0.38352145418514483 ,-0.39441847529847596 , -0.4621590457701291 , 0.9897802200622079 , 2.3991225798369857 , 1.56618776903183 , -0.26204443888209084 , 0, 0.9950893637319774 , 0.11069940324386887 , 0, 0, 0, -0.5243576981522252 , -0.5999389420793656 , -0.15635603039366897 , 0.6235734518443599 , -0.2566029126615301 , -0.7107498469869842 , -0.19789526989195863 , 0.852607572399835 , 1.0906540898559662 ,0.6659398918582315 , 1.6223019127254426 , 1.3314623056154833 , 0.2805177197205715 , 0.23295765041151617 , 0.8896855845396029";
#hdr = "4  , -0.2  , 1.014  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11063728667043862 , -0.9956015801280145 , 0, 0, 0, 0.5246054015438127 , 0.6002374988964428 , 0.15572035579672194 , -0.6237595902757028 , -0.648617024669081 , -1.5650125402294328 , -1.4902233040027593 , -0.14546234404254682 , 0.38371498837345064 ,-0.3948772248214199 , -0.46229524279153533 , 0.9916613973022288 , 2.4014466283143734 , 1.5656146628884224 , -0.26268502786309766 , 0, 0.9956015801280145 , 0.11063728667043862 , 0, 0, 0, -0.5246054015438127 , -0.6002374988964425 , -0.15572035579672172 , 0.6237595902757026 , -0.25684083851389405 , -0.7109529835294335 , -0.19728060298428388 , 0.8539943698378865 , 1.0906161726178516 ,0.6665916023465945 , 1.6232236238311517 , 1.3308460357258634 , 0.2791085819901973 , 0.2337332218062188 , 0.8901079727019271";
#hdr = "5  , -0.2  , 1.015  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11057524429438179 , -0.9961135174778792 , 0, 0, 0, 0.524852852122352 , 0.6005355754953379 , 0.15508535177093752 , -0.6239454737481374 , -0.6489734153961259 , -1.5658610916570637 , -1.4902221928545292 , -0.14475594619837717 , 0.38390812734798385 ,-0.39533561052239596 , -0.4624311332009405 , 0.9935414177131037 , 2.4037665683697327 , 1.5650404860807683 , -0.2633248967578738 , 0, 0.9961135174778792 , 0.11057524429438179 , 0, 0, 0, -0.5248528521223521 , -0.6005355754953381 , -0.15508535177093774 , 0.6239454737481374 , -0.25707844727862583 , -0.7111556204843031 , -0.1966659479321024 , 0.8553787896076124 , 1.0905781051311152 ,0.6672426011076754 , 1.6241436214718652 , 1.330228325820058 , 0.27770120818159005 , 0.23450874514135234 , 0.8905298754778231";
#hdr = "6  , -0.2  , 1.016  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11051327597474328 , -0.9966251762478076 , 0, 0, 0, 0.5251000501986373 , 0.6008331732361734 , 0.15445101732064392 , -0.6241311029378893 , -0.649329244436031 , -1.5667081864882513 , -1.4902204580186669 , -0.1440504263789834 , 0.3841008721025161 ,-0.3957936325245373 , -0.46256671832863266 , 0.9954202785887417 , 2.4060824075929066 , 1.5644652446214937 , -0.2639640465538928 , 0, 0.9966251762478076 , 0.11051327597474328 , 0, 0, 0, -0.5251000501986371 , -0.6008331732361736 , -0.15445101732064365 , 0.6241311029378892 , -0.2573157393853897 , -0.711357759056571 , -0.19605130742756852 , 0.8567608369977237 , 1.0905398881994175 ,0.6678928886835033 , 1.6250619088082423 , 1.3296091831977908 , 0.2762955958224915 , 0.23528421801794686 , 0.8909512934500221";
#hdr = "7  , -0.2  , 1.017  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.1104513815709437 , -0.9971365569027327 , 0, 0, 0, 0.5253469960833401 , 0.6011302934736573 , 0.1538173514518849 , -0.624316478518627 , -0.6496845125750652 , -1.5675538274586895 , -1.4902181022707586 , -0.14334578343402404 , 0.38429322362745055 ,-0.39625129095186684 , -0.4627019994999253 , 0.9972979772450669 , 2.408394153560974 , 1.5638889444964477 , -0.2646024782374817 , 0, 0.9971365569027327 , 0.1104513815709437 , 0, 0, 0, -0.5253469960833403 , -0.6011302934736578 , -0.15381735145188508 , 0.6243164785186265 , -0.25755271526329054 , -0.7115594004482747 , -0.19543668414588544 , 0.8581405172817055 , 1.090501522622094 ,0.6685424656171269 , 1.6259784889954627 , 1.3289886151281953 , 0.274891742439932 , 0.23605963804927088 , 0.8913722272007026";
#hdr = "8  , -0.2  , 1.018  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11038956094277855 , -0.9976476599062921 , 0, 0, 0, 0.5255936900870047 , 0.6014269375571207 , 0.1531843531724295 , -0.624501601161474 , -0.6500392205989227 , -1.56839801729792 , -1.4902151283736575 , -0.1426420162137308 , 0.3844851829098335 ,-0.39670858592929004 , -0.46283697803518287 , 0.9991745110198604 , 2.4107018138382452 , 1.56331159166485 , -0.2652401927938147 , 0, 0.9976476599062921 , 0.11038956094277855 , 0, 0, 0, -0.5255936900870046 , -0.6014269375571211 , -0.15318435317242962 , 0.624501601161474 , -0.25778937534087515 , -0.7117605458585173 , -0.1948220807454278 , 0.8595178357178607 , 1.09046300919419 ,0.669191332452596 , 1.62689336518323 , 1.3283666288499847 , 0.2734896455602871 , 0.23683500286077475 , 0.8917926773115049";
#hdr = "9  , -0.2  , 1.019  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11032781395041652 , -0.9981584857208307 , 0, 0, 0, 0.5258401325200411 , 0.6017231068305313 , 0.1525520214917584 , -0.6246864715350163 , -0.650393369292719 , -1.5692407587293282 , -1.4902115390775166 , -0.14193912356891292 , 0.3846767509333685 ,-0.3971655175825799 , -0.46297165524981426 , 1.0010498772726517 , 2.4130053959762057 , 1.562733192059368 , -0.26587719120690734 , 0, 0.9981584857208307 , 0.11032781395041652 , 0, 0, 0, -0.5258401325200412 , -0.6017231068305314 , -0.1525520214917584 , 0.6246864715350161 , -0.25802572004612573 , -0.7119611964834601 , -0.1942074998678186 , 0.8608927975493625 , 1.0904243487064629 ,0.6698394897349516 , 1.6278065405157438 , 1.3277432315715378 , 0.2720893027093201 , 0.2376103100900293 , 0.8922126443634947";
#hdr = "10  , -0.2  , 1.020  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.110266140454399 , -0.9986690348074068 , 0, 0, 0, 0.5260863236927285 , 0.6020188026325319 , 0.15192035542107096 , -0.6248710903053206 , -0.6507469594409911 , -1.5700820544701841 , -1.4902073371198892 , -0.14123710435097092 , 0.3848679286784332 ,-0.397622086038388 , -0.4631060324543064 , 1.0029240733846008 , 2.4153049075135735 , 1.5621537515863055 , -0.2665134744596134 , 0, 0.9986690348074068 , 0.110266140454399 , 0, 0, 0, -0.5260863236927283 , -0.6020188026325317 , -0.15192035542107046 , 0.6248710903053206 , -0.25826174980647065 , -0.7121613535163411 , -0.193592944138047 , 0.8622654080043124 , 1.0903855419454331 ,0.6704869380102197 , 1.6287180181317398 , 1.3271184304710861 , 0.2706907114122383 , 0.23838555738667289 , 0.8926321289371993";
#hdr = "11  , -0.2  , 1.021  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.1102045403156377 , -0.9991793076257973 , 0, 0, 0, 0.526332263915209 , 0.6023140262964557 , 0.1512893539732797 , -0.6250554581359417 , -0.6510999918276917 , -1.5709219072316412 , -1.490202525225768 , -0.14053595741190594 , 0.38505871712209205 ,-0.39807829142422235 , -0.46324011095421946 , 1.0047970967583826 , 2.4176003559762513 , 1.5615732761256838 , -0.2671490435336279 , 0, 0.9991793076257973 , 0.1102045403156377 , 0, 0, 0, -0.5263322639152088 , -0.6023140262964559 , -0.15128935397327936 , 0.6250554581359413 , -0.2584974650487756 , -0.7123610181474637 , -0.19297841616454975 , 0.8636356722957846 , 1.0903465896933902 ,0.6711336778254013 , 1.6296278011644558 , 1.326492232696816 , 0.26929386919374243 , 0.23916074241236107 , 0.8930511316125762";
#hdr = "12  , -0.2  , 1.022  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11014301339541449 , -0.9996893046345022 , 0, 0, 0, 0.5265779534974838 , 0.6026087791503633 , 0.15065901616300736 , -0.6252395756879341 , -0.6514524672361799 , -1.5717603197187517 , -1.4901971061076575 , -0.1398356816043308 , 0.3852491172381085 ,-0.39853413386845227 , -0.4633738920502213 , 1.0066689448180424 , 2.419891748877326 , 1.560991771531384 , -0.2677838994094711 , 0, 0.9996893046345022 , 0.11014301339541449 , 0, 0, 0, -0.5265779534974838 , -0.6026087791503633 , -0.15065901616300736 , 0.6252395756879341 , -0.25873286619934976 , -0.7125601915642112 , -0.19236391853932716 , 0.8650035956218811 , 1.0903074927284249 ,0.6717797097284544 , 1.6305358927416431 , 1.3258646453670093 , 0.26789877357806224 , 0.23993586284070578 , 0.8934696529690288";
#hdr = "13  , -0.2  , 1.023  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11008155955537921 , -1.000199026290749 , 0, 0, 0, 0.5268233927494126 , 0.6029030625170589 , 0.15002934100658838 , -0.6254234436198671 , -0.6518043864492251 , -1.5725972946304876 , -1.4901910824656373 , -0.13913627578147997 , 0.3854391299969636 ,-0.3989896135002986 , -0.46350737703807615 , 1.0085396150089045 , 2.422179093717075 , 1.5604092436312749 , -0.26841804306649464 , 0, 1.000199026290749 , 0.11008155955537921 , 0, 0, 0, -0.5268233927494125 , -0.6029030625170588 , -0.15002934100658838 , 0.6254234436198675 , -0.25896795368394393 , -0.7127588749510418 , -0.19174945383802386 , 0.866369183165784 , 1.090268251824454 ,0.6724250342682918 , 1.6314422959855701 , 1.3252356755701853 , 0.26650542208901784 , 0.24071091635722197 , 0.8938876935853944";
#hdr = "14  , -0.2  , 1.024  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11002017865754893 , -1.0007084730504991 , 0, 0, 0, 0.5270685819807113 , 0.6031968777141238 , 0.14940032752206334 , -0.6256070625878342 , -0.6521557502489987 , -1.5734328346597535 , -1.4901844569874245 , -0.13843773879722104 , 0.38562875636586713 ,-0.3994447304498313 , -0.46364056720868496 , 1.0104091047974424 , 2.4244623979829534 , 1.5598256982273329 , -0.26905147548287867 , 0, 1.0007084730504991 , 0.11002017865754893 , 0, 0, 0, -0.5270685819807112 , -0.6031968777141231 , -0.1494003275220629 , 0.6256070625878343 , -0.25920272792775273 , -0.7129570694895023 , -0.1911350246200327 , 0.8677324400958071 , 1.0902288677512415 ,0.6730696519947706 , 1.632347014013019 , 1.3246053303652279 , 0.2651138122500617 , 0.24148590065927478 , 0.8943052540399467";
#hdr = "15  , -0.2  , 1.025  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10995887056430587 , -1.0012176453684511 , 0, 0, 0, 0.5273135215009456 , 0.6034902260539334 , 0.14877197472917958 , -0.6257904332454636 , -0.6525065594170707 , -1.5742669424933966 , -1.4901772323484332 , -0.1377400695060616 , 0.38581799730877153 ,-0.3998994848479548 , -0.4637734638480657 , 1.0122774116711608 , 2.4267416691495827 , 1.5592411410957592 , -0.2696841976356225 , 0, 1.0012176453684511 , 0.10995887056430587 , 0, 0, 0, -0.5273135215009456 , -0.6034902260539332 , -0.14877197472917897 , 0.6257904332454638 , -0.2594371893554108 , -0.7131547763582192 , -0.19052063342859135 , 0.8690933715654385 , 1.0901893412744255 ,0.6737135634586779 , 1.6332500499352802 , 1.3239736167815148 , 0.26372394158432055 , 0.24226081345602224 , 0.8947223349103922";
#hdr = "16  , -0.2  , 1.026  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10989763513839773 , -1.0017265436980471 , 0, 0, 0, 0.5275582116195344 , 0.6037831088436921 , 0.1481442816493882 , -0.6259735562439326 , -0.6528568147344068 , -1.57509962081223 , -1.4901694112118438 , -0.13704326676316342 , 0.38600685378638755 ,-0.40035387682641915 , -0.46390606823740194 , 1.0141445331384844 , 2.4290169146787592 , 1.558655577987114 , -0.2703162105005458 , 0, 1.0017265436980471 , 0.10989763513839773 , 0, 0, 0, -0.5275582116195339 , -0.6037831088436919 , -0.14814428164938864 , 0.6259735562439327 , -0.25967133839100104 , -0.7133519967329142 , -0.18990628279087376 , 0.8704519827134038 , 1.090149673155541 ,0.674356769211725 , 1.634151406858161 , 1.323340541819059 , 0.26233580761465447 , 0.24303565246836412 , 0.8951389367738692";
#hdr = "0  , -0.2  , 1.027  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10983647224293483 , -1.0022351684914765 , 0, 0, 0, 0.5278026526457402 , 0.6040755273854508 , 0.14751724730584215 , -0.6261564322319756 , -0.6532065169813649 , -1.5759308722910377 , -1.490160996228651 , -0.13634732942434657 , 0.3861953267561965 ,-0.4008079065177964 , -0.4640383816530296 , 1.0160104667286347 , 2.4312881420194365 , 1.558069014626432 , -0.27094751505228365 , 0, 1.0022351684914765 , 0.10983647224293483 , 0, 0, 0, -0.5278026526457402 , -0.6040755273854506 , -0.14751724730584193 , 0.6261564322319757 , -0.2599051754580448 , -0.7135487317863977 , -0.18929197521808666 , 0.8718082786637084 , 1.09010986415204 ,0.6749992698065373 , 1.635051087881982 , 1.3227061124486181 , 0.2609494078636828 , 0.2438104154288876 , 0.8955550602069441";
#hdr = "1  , -0.2  , 1.028  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10977538174138937 , -1.0027435201996808 , 0, 0, 0, 0.5280468448886718 , 0.6043674829761387 , 0.14689087072339213 , -0.626339061855899 , -0.6535556669376867 , -1.5767606995985985 , -1.4901519900377427 , -0.13565225634610473 , 0.3863834171724648 ,-0.4012615740554902 , -0.46417040536646625 , 1.0178752099915158 , 2.4335553586077374 , 1.5574814567133428 , -0.2715781122642847 , 0, 1.0027435201996808 , 0.10977538174138937 , 0, 0, 0, -0.5280468448886716 , -0.6043674829761387 , -0.14689087072339185 , 0.626339061855899 , -0.2601387009795139 , -0.7137449826885836 , -0.18867771320556467 , 0.873162264525696 , 1.090069915017324 ,0.6756410657966393 , 1.6359490961015748 , 1.3220703356118555 , 0.259564739853848 , 0.24458510008182044 , 0.8959707057856129";
#hdr = "2  , -0.2  , 1.029  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10971436349759459 , -1.0032515992723594 , 0, 0, 0, 0.5282907886572794 , 0.604658976907581 , 0.14626515092859027 , -0.6265214457595899 , -0.6539042653825029 , -1.5775891053976934 , -1.4901423952659485 , -0.13495804638561326 , 0.38657112598625853 ,-0.4017148795737169 , -0.4643021406444153 , 1.0197387604976058 , 2.4358185718669283 , 1.5568929099221989 , -0.2722080031088077 , 0, 1.0032515992723594 , 0.10971436349759459 , 0, 0, 0, -0.5282907886572796 , -0.6046589769075812 , -0.14626515092859038 , 0.6265214457595898 , -0.2603719153778196 , -0.7139407506064832 , -0.18806349923286036 , 0.8745139453940829 , 1.0900298265007593 ,0.6762821577364531 , 1.6368454346062893 , 1.3214332182214488 , 0.2581818011074505 , 0.24535970418295527 , 0.8963858740852941";
#hdr = "3  , -0.2  , 1.030  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.10965341737574338 , -1.0037594061579738 , 0, 0, 0, 0.5285344842603524 , 0.6049500104665321 , 0.14564008694968011 , -0.6267035845845279 , -0.654252313094319 , -1.5784160923451245 , -1.490132214528102 , -0.13426469840073557 , 0.386758454145454 ,-0.4021678232075142 , -0.4644335887487885 , 1.0216011158378284 , 2.4380777892074352 , 1.5563033799021846 , -0.2728371885569177 , 0, 1.0037594061579738 , 0.10965341737574338 , 0, 0, 0, -0.5285344842603525 , -0.6049500104665319 , -0.14564008694968023 , 0.6267035845845279 , -0.2606048190748231 , -0.714136036704216 , -0.18744933576384085 , 0.8758633263490309 , 1.0899895993477013 ,0.6769225461812821 , 1.6377401064799848 , 1.3207947671612201 , 0.256800589146688 , 0.24613422549963493 , 0.8968005656808318";

hdr = "0  , 2.08  , NaN , NaN , NaN , NaN , NaN , NaN  , 0, 0.49999999999999994 , -0.9110433579144299 , 0, 0, 0, 2.8071845890578118 , -3.343701649134932 , 1.6596314689464302 , 2.101221365835647 , -5.125013611787107 , -0.08128021128372209 , 1.8005093712699787 , -6.30313209802169 , -6.095675305522816 ,14.223861840475191 , -5.498063517985193 , -4.97258295883006 , 27.553074215098174 , 5.293825381458536 , 0.9240665316226235 , 0, 0.9110433579144299 , 0.49999999999999994 , 0, 0, 0, -2.807184589057812 , 3.343701649134931 , -1.659631468946428 , -2.101221365835648 , 8.402237969222606 , -16.572120882721425 , 15.323620461325579 , 1.2183806628256297 , -3.4477667008876365 ,-21.315977713616427 , 37.442641374421825 , -14.241598542984985 , -25.028694947671955 , 14.595182576834455 , 17.655182233272363";
hdr = "1  , 2.14  , NaN , NaN , NaN , NaN , NaN , NaN  , 0, 0.5 , -0.9433981132056606 , 0, 0, 0, 2.622922115704563 , -3.3286207041799685 , 1.6817136365231014 , 2.108907651159088 , -4.783004756568571 , 0.5766077398187974 , 1.5783057726612975 , -6.354108502255421 , -5.7873979959931106 ,13.245556620540922 , -7.119869617213007 , -3.8414689263167716 , 26.728645488010777 , 4.808771992855549 , 0.25834470618265715 , 0, 0.9433981132056606 , 0.5 , 0, 0, 0, -2.6229221157045624 , 3.328620704179967 , -1.6817136365231016 , -2.108907651159086 , 7.685740471161829 , -15.847526981859225 , 14.98755675595217 , 1.2587409369226528 , -3.5290573325357775 ,-19.657491534706722 , 37.45904436248881 , -17.47461565856413 , -23.439829474461845 , 15.732132831409347 , 16.68731138331899";
hdr = "2  , 2.20  , NaN , NaN , NaN , NaN , NaN , NaN  , 0, 0.4999999999999999 , -0.9746794344808964 , 0, 0, 0, 2.4614562546470484 , -3.3154227866656965 , 1.7057180106201382 , 2.120213676190728 , -4.479237925996451 , 1.1385677136364172 , 1.3486981204133779 , -6.401846244726796 , -5.517416094704523 ,12.389551416170429 , -8.487927340575057 , -2.7694924208350926 , 26.08722868082707 , 4.315103048614603 , -0.319566396572287 , 0, 0.9746794344808964 , 0.4999999999999999 , 0, 0, 0, -2.4614562546470475 , 3.315422786665698 , -1.7057180106201377 , -2.120213676190727 , 7.077779051174874 , -15.239365952431415 , 14.730516512464348 , 1.2941400671053027 , -3.6136886113323055 ,-18.230968961710975 , 37.3581413844258 , -20.290293783126774 , -21.990842199415688 , 16.74255781743357 , 15.860688957447353";
hdr = "3  , 2.26  , NaN , NaN , NaN , NaN , NaN , NaN  , 0, 0.5000000000000001 , -1.004987562112089 , 0, 0, 0, 2.318599522031846 , -3.3042684633627593 , 1.7312989220933075 , 2.1345050247335786 , -4.207348301043295 , 1.6243992849034772 , 1.1162734284320148 , -6.447693942131545 , -5.278570205688229 ,11.633962237531337 , -9.660800531172812 , -1.7434129008210988 , 25.58352210585071 , 3.8181373800865757 , -0.8273807803662138 , 0, 1.004987562112089 , 0.5000000000000001 , 0, 0, 0, -2.318599522031845 , 3.3042684633627593 , -1.7312989220933064 , -2.1345050247335786 , 6.5552445903567556 , -14.724828236460256 , 14.538045852370791 , 1.3255494351914896 , -3.7013486526463977 ,-16.991955522599845 , 37.19194132167892 , -22.783925862975238 , -20.664974918304083 , 17.66078889969585 , 15.147139242931315";

hdr = "5  , -0.2  , 1.015  , -0.1  , NaN , NaN , NaN , NaN  , 0, 0.11057524429438179 , -0.9961135174778792 , 0, 0, 0, 0.524852852122352 , 0.6005355754953379 , 0.15508535177093752 , -0.6239454737481374 , -0.6489734153961259 , -1.5658610916570637 , -1.4902221928545292 , -0.14475594619837717 , 0.38390812734798385 ,-0.39533561052239596 , -0.4624311332009405 , 0.9935414177131037 , 2.4037665683697327 , 1.5650404860807683 , -0.2633248967578738 , 0, 0.9961135174778792 , 0.11057524429438179 , 0, 0, 0, -0.5248528521223521 , -0.6005355754953381 , -0.15508535177093774 , 0.6239454737481374 , -0.25707844727862583 , -0.7111556204843031 , -0.1966659479321024 , 0.8553787896076124 , 1.0905781051311152 ,0.6672426011076754 , 1.6241436214718652 , 1.330228325820058 , 0.27770120818159005 , 0.23450874514135234 , 0.8905298754778231";
hdr = "3  , 2.24  , NaN , NaN , NaN , NaN , NaN , NaN  , 0, 0.5 , -0.99498743710662 , 0, 0, 0, 2.364367286246598 , -3.3077556605465426 , 1.722614769944592 , 2.1294424226186615 , -4.294773386149388 , 1.4699045304242018 , 1.1938598256723472 , -6.432558221557192 , -5.355096563783994 ,11.875816089723042 , -9.288629832364734 , -2.0809821417214174 , 25.73833747310382 , 3.9839275606221154 , -0.6649948054574608 , 0, 0.99498743710662 , 0.5 , 0, 0, 0, -2.3643672862465976 , 3.307755660546543 , -1.7226147699445922 , -2.12944242261866 , 6.721091878524719 , -14.887103534494283 , 14.59577569914688 , 1.3154716636938502 , -3.6718084810715452 ,-17.386432064283866 , 37.252264140760715 , -21.983685737703205 , -21.094253597038914 , 17.363285033584646 , 15.373867631522483"

if hdr.split(',')[11].strip() != '0' or hdr.split(',')[12].strip() != '0' or hdr.split(',')[13].strip() != '0':
    print ("hdr: quadratic terms not zero, ABORT!")
    sys.exit()
if len(hdr.split(',')) == 50:     # generic quintic model (8 + 21 + 21)
    hdr_incr = 21
    print ("success ! quintic")
else:
    print ("Bad header length, not quintic !")
    sys.exit()

def prod_z_z (N1, p4, p3, p2, p1, p0, N2, q4, q3, q2, q1, q0):
    # multiply two (uniform) z polynomials to produce a new z polynomial (quintic)
    # first  : Sum_N1 (gik * z^i * zbar^k), degree N1
    # second : Sum_N2 (gik * z^i * zbar^k), degree N2

    ret = np.zeros((6,6), complex)    # final accumulated coeff of w^i*wbar^k
                                      # generated by z^i*zbar^k
    P = np.array([p4, p3, p2, p1, p0])
    Q = np.array([q4, q3, q2, q1, q0])
    for i in range (N1 + 1):
        for j in range (N2 + 1):
            #print (i, ',', j, ',', N1 + N2 - i - j, ',', i + j, ',', P[i], ',', Q[j])
            ret[N1 + N2 - i - j][i + j] += P[i]*Q[j]
    return ret

def prod_z_zbar (N1, p4, p3, p2, p1, p0, N2, q4, q3, q2, q1, q0):
    # multiply two (uniform) z polynomials to produce a new z polynomial (quintic)
    # first  : Sum_N1 (gik     * z^i * zbar^k) , degree N1
    # second : Sum_N2 (gik_bar * z^k * zbar^i) , degree N2

    ret = np.zeros((6,6), complex)    # final accumulated coeff of w^i*wbar^k
                                      # generated by z^i*zbar^k
    P = np.array([p4, p3, p2, p1, p0])
    Q = np.array([q4.conjugate(), q3.conjugate(), q2.conjugate(), q1.conjugate(), q0.conjugate()])
    for i in range (N1 + 1):
        for j in range (N2 + 1):
            #print (i, ',', j, ',', N1 + N2 - i - j, ',', i + j, ',', P[i], ',', Q[j])
            ret[N1 - i + j][N2 - j + i] += P[i]*Q[j]
    return ret

def prod_zbar_zbar (N1, p4, p3, p2, p1, p0, N2, q4, q3, q2, q1, q0):
    # multiply two (uniform) z polynomials to produce a new z polynomial (quintic)
    # first  : Sum_N1 (gik_bar * z^k * zbar^i) , degree N1
    # second : Sum_N2 (gik_bar * z^k * zbar^i) , degree N2

    ret = np.zeros((6,6), complex)    # final accumulated coeff of w^i*wbar^k
                                      # generated by z^i*zbar^k
    P = np.array([p4.conjugate(), p3.conjugate(), p2.conjugate(), p1.conjugate(), p0.conjugate()])
    Q = np.array([q4.conjugate(), q3.conjugate(), q2.conjugate(), q1.conjugate(), q0.conjugate()])
    for i in range (N1 + 1):
        for j in range (N2 + 1):
            #print (i, ',', j, ',', N1 + N2 - i - j, ',', i + j, ',', P[i], ',', Q[j])
            ret[i + j][N1 + N2 - i - j] += P[i]*Q[j]
    return ret

def concat (Ni, Nj):
    # expand function z^Ni*zbar^Nj in terms of w^l*wbar^m
    # calculate Xnew = Xold*Xin^Ni*Xin_bar*Nj
    Xold = np.zeros((6,6), complex)    # old accumulated coeff of w^l*wbar^m
    Xold[0][0] = 1
    Xnew = np.zeros((6,6), complex)    # new accumulated coeff of w^l*wbar^m
    #print ('\n', Ni, Nj, 'X0\n', X0.transpose().conjugate())
    for ni in range (Ni + Nj):
        if ni < Ni:
            Xin = X0                            # expand fxn z
        else:
            Xin = X0.transpose().conjugate()    # expand fxn zbar
        #print (ni, '\n', Xin)
        Xnew = np.zeros((6,6), complex)         # new accumulated coeff of w^l*wbar^m
        for oldi in range (6):
            for oldj in range (6 - oldi):
                for ini in range (6 - oldi - oldj):
                    for inj in range (6 - oldi - oldj - ini):
                        Xnew[oldi + ini][oldj + inj] += Xold[oldi][oldj]*Xin[ini][inj]
        #print (ni, '\n', Xnew)
        Xold = Xnew            
    return Xnew

def print_arr (arr):
    # print coeff of uniform polynomials
    print ('---------------')
    for i in range (len(arr)):
        for j in range (i + 1):
            print (arr[i - j][j], ',', end='')
        print ()
    print ('---------------')
    return

# parse a header given in the format of 'Chua_Simul_3.java'

g10 = complex(float(hdr.split(',')[9]), float(hdr.split(',')[9 + hdr_incr]))
print ("\ng10                , ", g10)

# for conversion matrices, use transpose of 'Minv' from 'expand_z.py'
# note gij coeff use factorial notation, Cxy do not

Cxy = np.array([complex(float(hdr.split(',')[14]), float(hdr.split(',')[14 + hdr_incr])), complex(float(hdr.split(',')[15]), float(hdr.split(',')[15 + hdr_incr])), \
                complex(float(hdr.split(',')[16]), float(hdr.split(',')[16 + hdr_incr])), complex(float(hdr.split(',')[17]), float(hdr.split(',')[17 + hdr_incr]))])
#print ("Cxy cubic,", Cxy) # see Chua_2D_cubic_variable_c1.py and IV p.9 and V p.2
g30 = 6*np.matmul(Cxy, np.array([complex(1, 0), complex(0, -1), complex(-1, 0), complex(0,  1)]))/8
g21 = 2*np.matmul(Cxy, np.array([complex(3, 0), complex(0, -1), complex( 1, 0), complex(0, -3)]))/8
g12 = 2*np.matmul(Cxy, np.array([complex(3, 0), complex(0,  1), complex( 1, 0), complex(0,  3)]))/8
g03 = 6*np.matmul(Cxy, np.array([complex(1, 0), complex(0,  1), complex(-1, 0), complex(0, -1)]))/8
print ("\ng30 g21 g12 g03    , ", g30, ",", g21, ",", g12, ",", g03)

h30 = g30/(g10*g10*g10 - g10)
h21 = 0j        # g21/(g10*g10*g10.conjugate() - g10)
h12 = g12/(g10*g10.conjugate()*g10.conjugate() - g10)
h03 = g03/(g10.conjugate()*g10.conjugate()*g10.conjugate() - g10)
print ("h30 h21 h12 h03    , ", h30, ",", h21, ",", h12, ",", h03)

Cxy = np.array([complex(float(hdr.split(',')[18]), float(hdr.split(',')[18 + hdr_incr])), complex(float(hdr.split(',')[19]), float(hdr.split(',')[19 + hdr_incr])), \
                complex(float(hdr.split(',')[20]), float(hdr.split(',')[20 + hdr_incr])), complex(float(hdr.split(',')[21]), float(hdr.split(',')[21 + hdr_incr])), \
                complex(float(hdr.split(',')[22]), float(hdr.split(',')[22 + hdr_incr]))])
#print ("Cxy quartic,", Cxy) # see Book 'Averaging' p. 57
g40 = 24*np.matmul(Cxy, np.array([complex(1, 0), complex(0,-1), complex(-1, 0), complex(0, 1), complex( 1, 0)]))/16
g31 =  6*np.matmul(Cxy, np.array([complex(4, 0), complex(0,-2), complex( 0, 0), complex(0,-2), complex(-4, 0)]))/16
g22 =  4*np.matmul(Cxy, np.array([complex(6, 0), complex(0, 0), complex( 2, 0), complex(0, 0), complex( 6, 0)]))/16
g13 =  6*np.matmul(Cxy, np.array([complex(4, 0), complex(0, 2), complex( 0, 0), complex(0, 2), complex(-4, 0)]))/16
g04 = 24*np.matmul(Cxy, np.array([complex(1, 0), complex(0, 1), complex(-1, 0), complex(0,-1), complex( 1, 0)]))/16
print ("\ng40 g31 g22 g13 g04, ", g40, ",", g31, ",", g22, ",", g13, ",", g04)

Cxy = np.array([complex(float(hdr.split(',')[23]), float(hdr.split(',')[23 + hdr_incr])), complex(float(hdr.split(',')[24]), float(hdr.split(',')[24 + hdr_incr])), \
                complex(float(hdr.split(',')[25]), float(hdr.split(',')[25 + hdr_incr])), complex(float(hdr.split(',')[26]), float(hdr.split(',')[26 + hdr_incr])), \
                complex(float(hdr.split(',')[27]), float(hdr.split(',')[27 + hdr_incr])), complex(float(hdr.split(',')[28]), float(hdr.split(',')[28 + hdr_incr]))])
print ("Cxy quintic,", Cxy)
g50 = 120*np.matmul(Cxy, np.array([  1, -1j, -1,  1j,  1,  -1j]))/32
g41 =  24*np.matmul(Cxy, np.array([  5, -3j, -1, -1j, -3,   5j]))/32
g32 =  12*np.matmul(Cxy, np.array([ 10, -2j,  2, -2j,  2, -10j]))/32
g23 =  12*np.matmul(Cxy, np.array([ 10,  2j,  2,  2j,  2,  10j]))/32
g14 =  24*np.matmul(Cxy, np.array([  5,  3j, -1,  1j, -3,  -5j]))/32
g05 = 120*np.matmul(Cxy, np.array([  1,  1j, -1, -1j,  1,   1j]))/32
print ("\ng50 g41 g32 g23 g14 g05, ", g50, ",", g41, ",", g32, ",", g23, ",", g14, ",", g05)

# generate inverse of a cubic z transform to quintic degree
# note that the existing quartic terms are unaffected

A50 = h30*h30/12 + h21*h03.conjugate()/12
A41 = h30*h21/4  + h21*h30/6 + h21*h12.conjugate()/4  + h12*h03.conjugate()/6
A32 = h30*h12/4  + h21*h21/2 + h21*h21.conjugate()/4  + h12*h12.conjugate()/2 + h12*h30/6  + h03*h03.conjugate()/12
A23 = h30*h03/12 + h21*h12/2 + h21*h30.conjugate()/12 + h12*h21.conjugate()/2 + h12*h21/4  + h03*h12.conjugate()/4
A14 =              h21*h03/6 + h12*h30.conjugate()/6                          + h12*h12/4  + h03*h21.conjugate()/4
A05 =                                                                           h12*h03/12 + h03*h30.conjugate()/12
print ("\nA50 A41 A32 A23 A14 A05, ", A50, ",", A41, ",", A32, ",", A23, ",", A14, ",", A05)
print ('--------------------------------------------------------------------')

#   generate the product of a quintic z-map and a cubic transform from z to w
#   to produce a quintic function in w
#   see attachment 'Propagation of Cubic/Quartic terms (Feb 28)

X0 = np.zeros((6,6), complex)    # final accumulated coeff of w^i*wbar^k
                                 # generated by z-map and z(w)
#print (g10, ',', g10*h20/2, ',', g10*h11, ',', g10*h02/2)
X0 += g10*prod_z_z (0, 1, 0, 0, 0, 0, 1,     1,     0,     0,     0,      0)
X0 += g10*prod_z_z (0, 1, 0, 0, 0, 0, 3, h30/6, h21/2, h12/2, h03/6,      0)

X0 += 1.0/6.0*g30*prod_z_z (1,       1,     0,       0, 0, 0, 2,     1,     0,     0,     0,  0)
X0 += 1.0/6.0*g30*prod_z_z (2,       3,     0,       0, 0, 0, 3, h30/6, h21/2, h12/2, h03/6,  0)

X0 += 0.5*g21*prod_z_zbar (2,     1,     0,     0,     0,  0, 1,     1,     0,     0,     0,  0)
X0 += 0.5*g21*prod_z_zbar (4, h30/6, h21/2, h12/2, h03/6,  0, 1,     2,     0,     0,     0,  0)
X0 += 0.5*g21*prod_z_zbar (2,     1,     0,    0,      0,  0, 3, h30/6, h21/2, h12/2, h03/6,  0)

X0 += 0.5*g12*prod_z_zbar (1,     1,     0,     0,     0, 0, 2,      1,     0,     0,     0,  0)
X0 += 0.5*g12*prod_z_zbar (1,     2,     0,     0,     0, 0, 4,  h30/6, h21/2, h12/2, h03/6,  0)
X0 += 0.5*g12*prod_z_zbar (3, h30/6, h21/2, h12/2, h03/6, 0, 2,      1,     0,     0,     0,  0)

X0 += 1.0/6.0*g03*prod_zbar_zbar (1,  1,  0,    0,     0, 0, 2,      1,     0,     0,     0,  0)
X0 += 1.0/6.0*g03*prod_zbar_zbar (2,  3,  0,    0,     0, 0, 3,  h30/6, h21/2, h12/2, h03/6,  0)

X0 += 1.0/24.0*g40*prod_z_z        (2,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)
X0 += 1.0/6.0*g31*prod_z_zbar      (3,   1,     0,     0, 0, 0, 1,     1,   0,     0,  0,  0)
X0 += 1.0/4.0*g22*prod_z_zbar      (2,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)
X0 += 1.0/6.0*g13*prod_z_zbar      (1,   1,     0,     0, 0, 0, 3,     1,   0,     0,  0,  0)
X0 += 1.0/24.0*g04*prod_zbar_zbar  (2,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)

X0 += 1.0/120.0*g50*prod_z_z       (3,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)
X0 += 1.0/24.0*g41*prod_z_zbar     (4,   1,     0,     0, 0, 0, 1,     1,   0,     0,  0,  0)
X0 += 1.0/12.0*g32*prod_z_zbar     (3,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)
X0 += 1.0/12.0*g23*prod_z_zbar     (2,   1,     0,     0, 0, 0, 3,     1,   0,     0,  0,  0)
X0 += 1.0/24.0*g14*prod_z_zbar     (1,   1,     0,     0, 0, 0, 4,     1,   0,     0,  0,  0)
X0 += 1.0/120.0*g05*prod_zbar_zbar (3,   1,     0,     0, 0, 0, 2,     1,   0,     0,  0,  0)

print ('X0 =\n', X0)
print ('arr X0')
print_arr (X0)

# invert the z(w) transform

W = np.zeros((6,6), complex)    # final w-map, based on X0: coeff of w^l*wbar^m
W = W + concat(1, 0) - h30*concat(3, 0)/6 - h21*concat(2, 1)/2 - h12*concat(1, 2)/2 - h03*concat(0, 3)/6
W = W + A50*concat(5, 0) + A41*concat(4, 1) + A32*concat(3, 2) + A23*concat(2, 3) + A14*concat(1, 4) + A05*concat(0, 5)

print ('W =\n', W)
print ('arr W')
print_arr (W)

# extract complex gij (non-factorial) notation of 'uniform_quartic.py'

Q3 = (W[3][0], W[2][1], W[1][2], W[0][3])
Q4 = (W[4][0], W[3][1], W[2][2], W[1][3], W[0][4])
Q5 = (W[5][0], W[4][1], W[3][2], W[2][3], W[1][4], W[0][5])
#Q3 = (0, W[2][1], 0, 0)        # redundant (keep only cylindrically symmetric)
Q4 = (0, 0, 0, 0, 0)            # DISABLE ALL quartic terms
#Q5 = (0, 0, 0, 0, 0, 0)         # DISABLE ALL quintic terms
Q5 = (0, 0, W[3][2], 0, 0, 0)   # keep only cylindrically symmetric
#Q5 = (W[5][0], 0, W[3][2], 0, W[1][4], 0)   # keep some quintic

print ("\nQ3, ", Q3)
print ("\nQ4, ", Q4)
print ("\nQ5, ", Q5)

# convert from gij (non-factorial) to complex (transformed) Dxy (non-factorial)
# for conversion matrices, use transpose of 'M' from 'expand_z.py'

D30 = np.matmul(Q3, np.array([  1,   1,   1,   1])) 
D21 = np.matmul(Q3, np.array([ 3j,  1j, -1j, -3j]))
D12 = np.matmul(Q3, np.array([ -3,   1,   1,  -3]))
D03 = np.matmul(Q3, np.array([-1j,  1j, -1j,  1j]))
print ("\nD30 D21 D12 D03    , ", D30, ",", D21, ",", D12, ",", D03)

D40 = np.matmul(Q4, np.array([  1,   1,   1,   1,   1])) 
D31 = np.matmul(Q4, np.array([ 4j,  2j,  0j, -2j, -4j]))
D22 = np.matmul(Q4, np.array([ -6,   0,   2,   0,  -6]))
D13 = np.matmul(Q4, np.array([-4j,  2j,  0j, -2j,  4j]))
D04 = np.matmul(Q4, np.array([  1,  -1,   1,  -1,   1]))
print ("\nD40 D31 D22 D13 D04, ", D40, ",", D31, ",", D22, ",", D13, ",", D04)

D50 = np.matmul(Q5, np.array([   1,   1,   1,   1,   1,   1])) 
D41 = np.matmul(Q5, np.array([  5j,  3j,  1j, -1j, -3j, -5j]))
D32 = np.matmul(Q5, np.array([ -10,  -2,   2,   2,  -2, -10]))
D23 = np.matmul(Q5, np.array([-10j,  2j,  2j, -2j, -2j, 10j]))
D14 = np.matmul(Q5, np.array([   5,  -3,   1,   1,  -3,   5]))
D05 = np.matmul(Q5, np.array([  1j, -1j,  1j, -1j,  1j, -1j]))
print ("\nD50 D41 D32 D23 D14 D05, ", D50, ",", D41, ",", D32, ",", D23, ",", D14, ",", D05)
print ()

#   print header for 'poly_roots.py'

print ('poly_roots = "', hdr.split(',')[0].strip(), ',',hdr.split(',')[1].strip(), ',', hdr.split(',')[2].strip(), ',', hdr.split(',')[3].strip(), ',', g10.real, ',', g10.imag, ',', Q3[1].real, ',', Q3[1].imag, ',', Q5[2].real, ',', Q5[2].imag, '"\n')

#   print transformed Dxy hdr

print ('    private static String hdr = "', end='')
temp = hdr.split(',')
for i in range(8):
    print (temp[i], ",", end='')
print (" 0,", g10.real, ",",-g10.imag, ", 0, 0, 0,", D30.real, ",", D21.real, ",", D12.real, ",", D03.real, ",", D40.real, ",", D31.real, ",", D22.real, ",", D13.real, ",", D04.real, ",", end='')
print (D50.real, ",", D41.real, ",", D32.real, ",", D23.real, ",", D14.real, ",", D05.real, ",", end='')
print (" 0,", g10.imag, ",", g10.real, ", 0, 0, 0,", D30.imag, ",", D21.imag, ",", D12.imag, ",", D03.imag, ",", D40.imag, ",", D31.imag, ",", D22.imag, ",", D13.imag, ",", D04.imag, ",", end='')
print (D50.imag, ",", D41.imag, ",", D32.imag, ",", D23.imag, ",", D14.imag, ",", D05.imag, end='')
print ('";')
